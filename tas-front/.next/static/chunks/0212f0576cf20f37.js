(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,48182,e=>{"use strict";var t=e.i(98961),a=e.i(2783),i=e.i(17851);let s=async()=>(await (0,t.getAllActivities)()).flatMap(e=>(e.attendances||[]).map(t=>({...t,activityId:t.activityId||e.id,activity:e}))),r=async e=>{let t=e.activityId;if(!t)throw Error("activityId is required");let s=await a.default.post(`/activities/${t}/apply`);return{id:s.data.id,activityId:s.data.activityId,userId:s.data.studentUserId,status:(0,i.mapApplicationStatusFromApi)(s.data.status),reason:s.data.remark||null,createdAt:s.data.submittedAt,updatedAt:s.data.updatedAt}},n=async(e,t={})=>{let s=(0,i.mapLegacyAttendanceAction)(t.status),r=await a.default.post(`/approvals/${e}/${"approve"===s?"approve":"request-revision"}`,{remark:t.remark||t.reason||t.rejectReason});return(0,i.normalizeAttendance)(r.data)},l=async e=>(await s()).filter(t=>t.userId===e||t.user?.id===e||t.user?.id===String(e)),o=async e=>{let a=await (0,t.getActivityById)(e);return(a.attendances||[]).map(t=>({...t,activityId:e,activity:a}))};e.s(["createAttendance",0,r,"getAllAttendances",0,s,"getAttendancesByActivity",0,o,"getAttendancesByUser",0,l,"updateAttendance",0,n])},46897,e=>{"use strict";let t=(0,e.i(75254).default)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);e.s(["MapPin",()=>t],46897)},60445,e=>{"use strict";e.i(47167);var t=e.i(71645),a=e.i(1072),i=e.i(26289),s=e.i(64517),r=e.i(62901),n=e.i(79573),l=e.i(28473),o=e.i(50824),d=e.i(32839),c=e.i(7670),m=e.i(11517),u=e.i(76398),p=e.i(63731),x=e.i(42064);e.i(96059);var h=e.i(15654),g=e.i(83293),f=e.i(46422);let y=(e,t,a,i,s)=>({background:e,border:`${(0,h.unit)(i.lineWidth)} ${i.lineType} ${t}`,[`${s}-icon`]:{color:a}}),v=(0,f.genStyleHooks)("Alert",e=>[(e=>{let{componentCls:t,motionDurationSlow:a,marginXS:i,marginSM:s,fontSize:r,fontSizeLG:n,lineHeight:l,borderRadiusLG:o,motionEaseInOutCirc:d,withDescriptionIconSize:c,colorText:m,colorTextHeading:u,withDescriptionPadding:p,defaultPadding:x}=e;return{[t]:{...(0,g.resetComponent)(e),position:"relative",display:"flex",alignItems:"center",padding:x,wordWrap:"break-word",borderRadius:o,[`&${t}-rtl`]:{direction:"rtl"},[`${t}-section`]:{flex:1,minWidth:0},[`${t}-icon`]:{marginInlineEnd:i,lineHeight:0},"&-description":{display:"none",fontSize:r,lineHeight:l},"&-title":{color:u},[`&${t}-motion-leave`]:{overflow:"hidden",opacity:1,transition:`max-height ${a} ${d}, opacity ${a} ${d},
        padding-top ${a} ${d}, padding-bottom ${a} ${d},
        margin-bottom ${a} ${d}`},[`&${t}-motion-leave-active`]:{maxHeight:0,marginBottom:"0 !important",paddingTop:0,paddingBottom:0,opacity:0}},[`${t}-with-description`]:{alignItems:"flex-start",padding:p,[`${t}-icon`]:{marginInlineEnd:s,fontSize:c,lineHeight:0},[`${t}-title`]:{display:"block",marginBottom:i,color:u,fontSize:n},[`${t}-description`]:{display:"block",color:m}},[`${t}-banner`]:{marginBottom:0,border:"0 !important",borderRadius:0}}})(e),(e=>{let{componentCls:t,colorSuccess:a,colorSuccessBorder:i,colorSuccessBg:s,colorWarning:r,colorWarningBorder:n,colorWarningBg:l,colorError:o,colorErrorBorder:d,colorErrorBg:c,colorInfo:m,colorInfoBorder:u,colorInfoBg:p}=e;return{[t]:{"&-success":y(s,i,a,e,t),"&-info":y(p,u,m,e,t),"&-warning":y(l,n,r,e,t),"&-error":{...y(c,d,o,e,t),[`${t}-description > pre`]:{margin:0,padding:0}}}}})(e),(e=>{let{componentCls:t,iconCls:a,motionDurationMid:i,marginXS:s,fontSizeIcon:r,colorIcon:n,colorIconHover:l}=e;return{[t]:{"&-actions":{marginInlineStart:s},[`${t}-close-icon`]:{marginInlineStart:s,padding:0,overflow:"hidden",fontSize:r,lineHeight:(0,h.unit)(r),backgroundColor:"transparent",border:"none",outline:"none",cursor:"pointer",[`${a}-close`]:{color:n,transition:`color ${i}`,"&:hover":{color:l}}},"&-close-text":{color:n,transition:`color ${i}`,"&:hover":{color:l}}}}})(e)],e=>({withDescriptionIconSize:e.fontSizeHeading3,defaultPadding:`${e.paddingContentVerticalSM}px 12px`,withDescriptionPadding:`${e.paddingMD}px ${e.paddingContentHorizontalLG}px`})),b={success:a.default,info:n.default,error:i.default,warning:r.default},j=e=>{let{icon:a,prefixCls:i,type:s,className:r,style:n}=e,l=b[s]||null;return a?(0,p.replaceElement)(a,t.createElement("span",{className:`${i}-icon`},a),()=>({className:(0,c.clsx)(a.props.className,r),style:n})):t.createElement(l,{className:r,style:n})},N=e=>{let{isClosable:a,prefixCls:i,closeIcon:r,handleClose:n,ariaProps:l}=e,o=!0===r||void 0===r?t.createElement(s.default,null):r;return a?t.createElement("button",{type:"button",onClick:n,className:`${i}-close-icon`,tabIndex:0,...l},o):null},A=t.forwardRef((e,a)=>{let{description:i,prefixCls:s,message:r,title:n,banner:p,className:h,rootClassName:g,style:f,onMouseEnter:y,onMouseLeave:b,onClick:A,afterClose:C,showIcon:I,closable:$,closeText:S,closeIcon:w,action:E,id:k,styles:T,classNames:R,...D}=e,M=n??r,[H,P]=t.useState(!1),z=t.useRef(null);t.useImperativeHandle(a,()=>({nativeElement:z.current}));let{getPrefixCls:B,direction:L,closable:O,closeIcon:U,className:q,style:G,classNames:V,styles:W}=(0,x.useComponentConfig)("alert"),_=B("alert",s),[F,K]=v(_),{onClose:J,afterClose:Q}=$&&"object"==typeof $?$:{},X=t=>{P(!0),(J??e.onClose)?.(t)},Y=t.useMemo(()=>void 0!==e.type?e.type:p?"warning":"info",[e.type,p]),Z=t.useMemo(()=>"object"==typeof $&&!!$.closeIcon||!!S||("boolean"==typeof $?$:!!(!1!==w&&(0,u.default)(w))||!!O),[S,w,$,O]),ee=!!p&&void 0===I||I,et={...e,prefixCls:_,type:Y,showIcon:ee,closable:Z},[ea,ei]=(0,m.useMergeSemantic)([V,R],[W,T],{props:et}),es=(0,c.clsx)(_,`${_}-${Y}`,{[`${_}-with-description`]:!!i,[`${_}-no-icon`]:!ee,[`${_}-banner`]:!!p,[`${_}-rtl`]:"rtl"===L},q,h,g,ea.root,K,F),er=(0,o.default)(D,{aria:!0,data:!0}),en=t.useMemo(()=>"object"==typeof $&&$.closeIcon?$.closeIcon:S||(void 0!==w?w:"object"==typeof O&&O.closeIcon?O.closeIcon:U),[w,$,O,S,U]),el=t.useMemo(()=>{let e=$??O;return"object"==typeof e?(0,o.default)(e,{data:!0,aria:!0}):{}},[$,O]);return t.createElement(l.default,{visible:!H,motionName:`${_}-motion`,motionAppear:!1,motionEnter:!1,onLeaveStart:e=>({maxHeight:e.offsetHeight}),onLeaveEnd:Q??C},({className:a,style:s},r)=>t.createElement("div",{id:k,ref:(0,d.composeRef)(z,r),"data-show":!H,className:(0,c.clsx)(es,a),style:{...ei.root,...G,...f,...s},onMouseEnter:y,onMouseLeave:b,onClick:A,role:"alert",...er},ee?t.createElement(j,{className:(0,c.clsx)(`${_}-icon`,ea.icon),style:ei.icon,description:i,icon:e.icon,prefixCls:_,type:Y}):null,t.createElement("div",{className:(0,c.clsx)(`${_}-section`,ea.section),style:ei.section},M?t.createElement("div",{className:(0,c.clsx)(`${_}-title`,ea.title),style:ei.title},M):null,i?t.createElement("div",{className:(0,c.clsx)(`${_}-description`,ea.description),style:ei.description},i):null),E?t.createElement("div",{className:(0,c.clsx)(`${_}-actions`,ea.actions),style:ei.actions},E):null,t.createElement(N,{isClosable:Z,prefixCls:_,closeIcon:en,handleClose:X,ariaProps:el})))});var C=e.i(78409),I=e.i(33848),$=e.i(87806),S=e.i(79671),w=e.i(80002),E=e.i(68917);let k=function(e){function a(){var e,t,i;return(0,C.default)(this,a),t=a,i=arguments,t=(0,$.default)(t),(e=(0,w.default)(this,(0,S.default)()?Reflect.construct(t,i||[],(0,$.default)(this).constructor):t.apply(this,i))).state={error:void 0,info:{componentStack:""}},e}return(0,E.default)(a,e),(0,I.default)(a,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e,info:t})}},{key:"render",value:function(){let{message:e,title:a,description:i,id:s,children:r}=this.props,{error:n,info:l}=this.state,o=a??e,d=l?.componentStack||null,c=void 0===o?(n||"").toString():o;return n?t.createElement(A,{id:s,type:"error",title:c,description:t.createElement("pre",{style:{fontSize:"0.9em",overflowX:"auto"}},void 0===i?d:i)}):r}}])}(t.Component);A.ErrorBoundary=k,e.s(["Alert",0,A],60445)},43325,e=>{"use strict";var t=e.i(43476),a=e.i(71645),i=e.i(60445),s=e.i(64571),r=e.i(75712),n=e.i(78654),l=e.i(12931),o=e.i(97650),d=e.i(21192),c=e.i(82725),m=e.i(62218),u=e.i(98573),p=e.i(51804),x=e.i(69638),h=e.i(3116),g=e.i(46897),f=e.i(61911),y=e.i(98961),v=e.i(48182),b=e.i(2783);let j=async()=>(await b.default.get("/students/me/progress")).data,N=new Set(["APPLIED","APPROVED","REVISION_REQUIRED"]),A=e=>{if(!e)return"-";let t=new Date(e);return Number.isNaN(t.getTime())?"-":t.toLocaleDateString("th-TH",{year:"numeric",month:"long",day:"numeric"})},C=(e,t)=>{if(!e||!t)return"ไม่ระบุเวลา";let a=new Date(e),i=new Date(t);return Number.isNaN(a.getTime())||Number.isNaN(i.getTime())?"ไม่ระบุเวลา":`${a.toLocaleTimeString("th-TH",{hour:"2-digit",minute:"2-digit"})} - ${i.toLocaleTimeString("th-TH",{hour:"2-digit",minute:"2-digit"})}`},I=e=>e?Array.isArray(e)?e.filter(Boolean):[e]:[];function $(){let[e,b]=(0,a.useState)(null),[$,S]=(0,a.useState)([]),[w,E]=(0,a.useState)([]),[k,T]=(0,a.useState)(null),[R,D]=(0,a.useState)(!0),[M,H]=(0,a.useState)(!1),[P,z]=(0,a.useState)(null),[B,L]=(0,a.useState)(!1),O=async e=>{if(e?.id){D(!0);try{let[t,a,i]=await Promise.all([(0,y.getAllActivities)({status:"OPEN_REGISTRATION"}),(0,v.getAttendancesByUser)(e.id),j()]);S(Array.isArray(t)?t:[]),E(Array.isArray(a)?a:[]),T(i||null)}catch(t){let e=t?.response?.data?.message||"ไม่สามารถโหลดข้อมูลนักศึกษาได้";u.message.error(e)}finally{D(!1)}}};(0,a.useEffect)(()=>{try{let e=localStorage.getItem("user"),t=e?JSON.parse(e):null;b(t),t?.id?O(t):D(!1)}catch(e){D(!1)}},[]);let U=(0,a.useMemo)(()=>new Set(w.map(e=>e.activityId)),[w]),q=(0,a.useMemo)(()=>$.filter(t=>((e,t)=>{let a={facultyId:t?.facultyId||t?.faculty?.id||null,departmentId:t?.departmentId||t?.department?.id||null,majorId:t?.majorId||t?.major?.id||null},i=I(e.departmentIds),s=I(e.majorIds);if(i.length>0){if(!a.departmentId||!i.includes(a.departmentId))return!1}else if("DEPARTMENT"===e.ownerScope&&e.departmentId){if(!a.departmentId||e.departmentId!==a.departmentId)return!1}else if("FACULTY"===e.ownerScope&&e.facultyId&&(!a.facultyId||e.facultyId!==a.facultyId))return!1;return!(s.length>0)||!!a.majorId&&!!s.includes(a.majorId)})(t,e)),[$,e]),G=(0,a.useMemo)(()=>({totalActivities:q.length,joinedCount:q.filter(e=>U.has(e.id)).length}),[q,U]),V=async()=>{if(P?.id&&e?.id){H(!0);try{await (0,v.createAttendance)({activityId:P.id}),u.message.success(`ลงทะเบียนกิจกรรม "${P.name}" สำเร็จ`),L(!1),z(null),await O(e)}catch(t){let e=t?.response?.data?.message||"ไม่สามารถลงทะเบียนกิจกรรมได้";u.message.error(e)}finally{H(!1)}}};return(0,t.jsx)(c.Spin,{spinning:R,children:(0,t.jsxs)("div",{children:[(0,t.jsx)(r.Card,{className:"mb-6 shadow-sm",style:{background:"linear-gradient(135deg, #0A894C 0%, #0ea258 100%)",border:"none"},children:(0,t.jsxs)("div",{className:"text-white",children:[(0,t.jsxs)("h2",{className:"text-2xl font-bold mb-1",children:["สวัสดี, ",e?.fullname||"นักศึกษา"]}),(0,t.jsx)("p",{className:"text-sm opacity-90",children:"ข้อมูลกิจกรรมและชั่วโมงสะสมของคุณ"})]})}),k&&(0,t.jsx)(r.Card,{className:"mb-4",children:(0,t.jsxs)(d.Row,{gutter:[16,16],children:[(0,t.jsxs)(n.Col,{xs:24,md:8,children:[(0,t.jsx)("div",{className:"text-sm text-gray-500",children:"ชั่วโมงสะสม"}),(0,t.jsx)("div",{className:"text-3xl font-bold text-[#0A894C]",children:k.totalHours||0})]}),(0,t.jsxs)(n.Col,{xs:24,md:8,children:[(0,t.jsx)("div",{className:"text-sm text-gray-500",children:"เป้าหมาย"}),(0,t.jsx)("div",{className:"text-3xl font-bold text-[#0A894C]",children:k.targetHours||60})]}),(0,t.jsxs)(n.Col,{xs:24,md:8,children:[(0,t.jsx)("div",{className:"text-sm text-gray-500",children:"ความคืบหน้า"}),(0,t.jsx)(o.Progress,{percent:k.percent||0,strokeColor:"#0A894C"}),(0,t.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["นอกชั้นเรียน: ",k.breakdown?.completedRecordHours||0," | เข้าร่วมกิจกรรม:"," ",k.breakdown?.approvedActivityHours||0]})]})]})}),(0,t.jsxs)(d.Row,{gutter:[16,16],className:"mb-4",children:[(0,t.jsx)(n.Col,{xs:24,md:12,children:(0,t.jsxs)(r.Card,{children:[(0,t.jsx)("div",{className:"text-sm text-gray-500",children:"กิจกรรมที่เปิดให้คุณเข้าร่วม"}),(0,t.jsx)("div",{className:"text-3xl font-bold text-[#0A894C]",children:G.totalActivities})]})}),(0,t.jsx)(n.Col,{xs:24,md:12,children:(0,t.jsxs)(r.Card,{children:[(0,t.jsx)("div",{className:"text-sm text-gray-500",children:"กิจกรรมที่คุณสมัครแล้ว"}),(0,t.jsx)("div",{className:"text-3xl font-bold text-[#0A894C]",children:G.joinedCount})]})})]}),(0,t.jsxs)(r.Card,{children:[(0,t.jsx)("div",{className:"mb-4",children:(0,t.jsx)("h3",{className:"text-lg font-semibold text-[#0A894C]",children:"รายการกิจกรรมที่เปิดรับสมัคร"})}),0===q.length?(0,t.jsx)(i.Alert,{type:"info",message:"ไม่พบกิจกรรมที่เปิดรับสมัครสำหรับสาขา/ภาควิชาของคุณ"}):(0,t.jsx)(d.Row,{gutter:[16,16],children:q.map(e=>{let a=I(e.attendances).filter(e=>N.has(e.status)).length,i=Number(e.maxPeopleCount||e.maxStudents||0),l=i>0&&a>=i,o=U.has(e.id);return(0,t.jsx)(n.Col,{xs:24,md:12,lg:8,children:(0,t.jsxs)(r.Card,{hoverable:!0,style:{borderRadius:12,border:"1px solid #e8f5e9",boxShadow:"0 2px 8px rgba(10, 137, 76, 0.08)"},children:[(0,t.jsx)("div",{className:"mb-2",children:(0,t.jsx)(m.Tag,{color:"green",children:e.typeActivity?.name||"ยังไม่กำหนดประเภท"})}),(0,t.jsx)("h4",{className:"text-base font-semibold mb-3",children:e.name}),(0,t.jsxs)("div",{className:"space-y-2 text-sm text-gray-600 mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(p.CalendarCheck,{size:16}),(0,t.jsx)("span",{children:A(e.startAt||e.startDate)})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(h.Clock,{size:16}),(0,t.jsxs)("span",{children:[C(e.startAt||e.startDate,e.endAt||e.endDate)," (",e.hours||e.hour||0," ชั่วโมง)"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(g.MapPin,{size:16}),(0,t.jsx)("span",{className:"line-clamp-1",children:e.location||e.address||"-"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(f.Users,{size:16}),(0,t.jsxs)("span",{children:[a,"/",i||"-"," คน"]})]})]}),(0,t.jsx)(s.Button,{type:"primary",block:!0,disabled:l||o,onClick:()=>{z(e),L(!0)},style:{backgroundColor:o?"#10b981":l?"#d1d5db":"#0A894C",borderColor:o?"#10b981":l?"#d1d5db":"#0A894C"},children:o?"เข้าร่วมแล้ว":l?"เต็ม":"ลงทะเบียน"})]})},e.id)})})]}),(0,t.jsx)(l.Modal,{title:"ยืนยันการลงทะเบียนกิจกรรม",open:B,onOk:V,onCancel:()=>{L(!1),z(null)},confirmLoading:M,okText:"ยืนยัน",cancelText:"ยกเลิก",okButtonProps:{style:{backgroundColor:"#0A894C",borderColor:"#0A894C"}},children:P&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("h4",{className:"font-semibold",children:P.name}),(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:["วันที่: ",A(P.startAt||P.startDate)]}),(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:["เวลา:"," ",C(P.startAt||P.startDate,P.endAt||P.endDate)]}),(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:["สถานที่: ",P.location||P.address||"-"]}),(0,t.jsxs)("div",{className:"p-3 rounded-lg bg-green-50 border border-green-200 text-green-800 text-sm",children:[(0,t.jsx)(x.CheckCircle,{size:16,className:"inline mr-1"}),"เมื่อผ่านการอนุมัติจะได้รับ ",P.hours||P.hour||0," ชั่วโมง"]})]})})]})})}e.s(["default",()=>$],43325)}]);