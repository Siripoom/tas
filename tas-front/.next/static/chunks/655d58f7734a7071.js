(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,46333,e=>{"use strict";var s=e.i(43476),t=e.i(71645),r=e.i(75712),l=e.i(78654),o=e.i(16303),o=o,a=e.i(97650),i=e.i(21192),c=e.i(82725),d=e.i(62218),n=e.i(98573),x=e.i(21218),m=e.i(87316),u=e.i(69638),h=e.i(3116),j=e.i(78583),g=e.i(25652),p=e.i(61911),f=e.i(98961),y=e.i(75312);let b=[{color:"#0A894C",icon:(0,s.jsx)(j.FileText,{size:20})},{color:"#1890ff",icon:(0,s.jsx)(x.Activity,{size:20})},{color:"#fa8c16",icon:(0,s.jsx)(m.Calendar,{size:20})},{color:"#52c41a",icon:(0,s.jsx)(p.Users,{size:20})},{color:"#eb2f96",icon:(0,s.jsx)(g.TrendingUp,{size:20})},{color:"#722ed1",icon:(0,s.jsx)(u.CheckCircle,{size:20})}],N={OPEN_REGISTRATION:"เปิดรับสมัคร",IN_PROGRESS:"กำลังดำเนินการ",CLOSED:"ปิดกิจกรรม",CANCELLED:"ยกเลิกกิจกรรม"};function C(){let[e,g]=(0,t.useState)(!1),[C,v]=(0,t.useState)(null),[A,w]=(0,t.useState)([]);(0,t.useEffect)(()=>{v((0,y.getUserScope)())},[]),(0,t.useEffect)(()=>{(async()=>{if(!C?.departmentId)return n.message.error("ไม่พบข้อมูลภาควิชาของผู้ใช้");g(!0);try{let e=await (0,f.getAllActivities)({departmentId:C.departmentId});w(Array.isArray(e)?e:[])}catch(e){console.error("Error fetching teacher home data:",e),n.message.error("ไม่สามารถโหลดข้อมูลได้")}finally{g(!1)}})()},[C]);let E=(0,t.useMemo)(()=>(Array.isArray(A)?A:[]).filter(e=>((e,s)=>!!s&&(Array.isArray(e?.departments)&&e.departments.length>0?e.departments:e?.department?.id?[e.department]:[]).some(e=>e?.id===s))(e,C?.departmentId)),[A,C?.departmentId]),S=(0,t.useMemo)(()=>{let e=new Set;return E.forEach(s=>{(s.attendances||[]).forEach(s=>{s?.user?.id&&e.add(s.user.id)})}),e.size},[E]),T=(0,t.useMemo)(()=>E.reduce((e,s)=>e+(s.attendances||[]).filter(e=>["APPLIED","REVISION_REQUIRED"].includes(e.status)).length,0),[E]),I=(0,t.useMemo)(()=>E.filter(e=>"IN_PROGRESS"===e.status).length,[E]),R=(0,t.useMemo)(()=>E.reduce((e,s)=>e+Number(s.hour||s.hours||0),0),[E]),k=(0,t.useMemo)(()=>{let e=new Map;return E.forEach(s=>{let t=s.typeActivity?.id||s.typeActivityId||"unknown",r=s.typeActivity?.name||"ยังไม่กำหนดประเภท",l=b[((e="")=>Array.from(String(e)).reduce((e,s)=>e+s.charCodeAt(0),0))(t)%b.length];e.has(t)||e.set(t,{id:t,name:r,eventsCount:0,currentHours:0,targetHours:60,color:l.color,icon:l.icon});let o=e.get(t);o.eventsCount+=1,o.currentHours+=Number(s.hour||s.hours||0)}),Array.from(e.values())},[E]),z=(0,t.useMemo)(()=>[...E].sort((e,s)=>new Date(s.updatedAt||s.createdAt||s.startAt).getTime()-new Date(e.updatedAt||e.createdAt||e.startAt).getTime()).slice(0,4),[E]),H=[{title:"Total Students",value:S,icon:(0,s.jsx)(p.Users,{size:24,style:{color:"#0A894C"}}),color:"#0A894C"},{title:"Total Events",value:E.length,icon:(0,s.jsx)(m.Calendar,{size:24,style:{color:"#0db359"}}),color:"#0db359"},{title:"Pending Approvals",value:T,icon:(0,s.jsx)(j.FileText,{size:24,style:{color:"#086b3d"}}),color:"#086b3d"},{title:"Active Events",value:I,icon:(0,s.jsx)(x.Activity,{size:24,style:{color:"#05c168"}}),color:"#05c168"}];return(0,s.jsxs)("div",{children:[(0,s.jsx)(r.Card,{className:"mb-6 shadow-sm",style:{background:"linear-gradient(135deg, #0A894C 0%, #0ea258 100%)",border:"none"},children:(0,s.jsxs)("div",{className:"text-white",children:[(0,s.jsxs)("h2",{className:"text-2xl font-bold mb-2",children:["ภาควิชา ",C?.departmentName||"ไม่ระบุ"]}),(0,s.jsx)("p",{className:"text-sm opacity-90",children:"สรุปกิจกรรมและการติดตามงานของภาควิชา"})]})}),(0,s.jsxs)(c.Spin,{spinning:e,children:[(0,s.jsx)(i.Row,{gutter:[16,16],children:H.map(e=>(0,s.jsx)(l.Col,{xs:24,sm:12,lg:6,children:(0,s.jsx)(r.Card,{hoverable:!0,className:"shadow-sm",styles:{body:{padding:24}},children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-gray-500 text-sm mb-1",children:e.title}),(0,s.jsx)("p",{className:"text-2xl font-bold",style:{color:e.color},children:e.value})]}),(0,s.jsx)("div",{className:"p-3 rounded-full",style:{backgroundColor:`${e.color}15`},children:e.icon})]})})},e.title))}),(0,s.jsx)(r.Card,{className:"mt-6 shadow-sm",styles:{header:{backgroundColor:"#e8f5e9",borderBottom:"2px solid #0A894C",color:"#086b3d",fontWeight:"600"}},title:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(h.Clock,{size:20,style:{color:"#0A894C"}}),(0,s.jsx)("span",{children:"จำนวนชั่วโมงกิจกรรมตามประเภท"})]}),children:0===k.length?(0,s.jsx)(o.default,{description:"ยังไม่มีกิจกรรมในภาควิชานี้"}):(0,s.jsx)(i.Row,{gutter:[16,16],children:k.map(e=>{let t=Math.min(100,Math.round(e.currentHours/e.targetHours*100));return(0,s.jsx)(l.Col,{xs:24,md:12,lg:8,children:(0,s.jsx)(r.Card,{hoverable:!0,className:"h-full",style:{borderLeft:`4px solid ${e.color}`,backgroundColor:"#fafafa"},children:(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg",style:{backgroundColor:`${e.color}15`,color:e.color},children:e.icon}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-semibold text-sm mb-1",style:{color:e.color},children:e.name}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:[e.currentHours,"/",e.targetHours," ชั่วโมง"]})]})]}),e.currentHours>=e.targetHours&&(0,s.jsx)(u.CheckCircle,{size:16,style:{color:"#52c41a"}})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2 pt-2 border-t",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"กิจกรรม"}),(0,s.jsx)("p",{className:"text-lg font-bold text-gray-800",children:e.eventsCount})]}),(0,s.jsxs)("div",{className:"text-center border-l",children:[(0,s.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"ชั่วโมง"}),(0,s.jsx)("p",{className:"text-lg font-bold",style:{color:e.color},children:e.currentHours})]})]}),(0,s.jsx)(a.Progress,{percent:t,showInfo:!1,strokeColor:e.color})]})})},e.id)})})}),(0,s.jsxs)(i.Row,{gutter:[16,16],className:"mt-6",children:[(0,s.jsx)(l.Col,{xs:24,lg:16,children:(0,s.jsx)(r.Card,{title:"Recent Activities",className:"shadow-sm",styles:{header:{backgroundColor:"#e8f5e9",borderBottom:"2px solid #0A894C",color:"#086b3d",fontWeight:"600"}},children:0===z.length?(0,s.jsx)(o.default,{description:"ไม่มีกิจกรรมล่าสุด"}):(0,s.jsx)("div",{className:"space-y-3",children:z.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg",style:{backgroundColor:"#f1f8f4",borderLeft:"3px solid #0A894C"},children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-800",children:e.name||e.title}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:["วันที่จัด ",(e=>{if(!e)return"-";let s=new Date(e);return Number.isNaN(s.getTime())?"-":s.toLocaleDateString("th-TH")})(e.startDate||e.startAt)]})]}),(0,s.jsx)(d.Tag,{color:"blue",children:N[e.status]||e.status})]},e.id))})})}),(0,s.jsx)(l.Col,{xs:24,lg:8,children:(0,s.jsx)(r.Card,{title:"Notifications",className:"shadow-sm",styles:{header:{backgroundColor:"#e8f5e9",borderBottom:"2px solid #0A894C",color:"#086b3d",fontWeight:"600"}},children:(0,s.jsx)(o.default,{description:"ยังไม่มีการเชื่อมต่อแจ้งเตือนในหน้านี้"})})})]}),(0,s.jsx)(r.Card,{className:"mt-6 shadow-sm",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-gray-600",children:"ชั่วโมงกิจกรรมรวมภาควิชา"}),(0,s.jsxs)("span",{className:"text-lg font-bold",style:{color:"#0A894C"},children:[R," ชั่วโมง"]})]})})]})]})}e.s(["default",()=>C],46333)}]);