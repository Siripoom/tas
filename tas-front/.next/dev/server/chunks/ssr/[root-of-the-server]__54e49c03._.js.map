{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///home/siripoom/tas/tas-front/src/components/asset/AdminHeader.js"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport { useRouter, usePathname } from \"next/navigation\";\nimport { Avatar, Dropdown, Breadcrumb } from \"antd\";\nimport { LogOut, User, Settings, Home } from \"lucide-react\";\nimport Image from \"next/image\";\n\nconst AdminHeader = () => {\n  const router = useRouter();\n  const pathname = usePathname();\n  const [userInfo, setUserInfo] = useState(null);\n\n  useEffect(() => {\n    // อ่านข้อมูลจาก localStorage\n    const storedUser = localStorage.getItem(\"user\");\n    if (storedUser) {\n      try {\n        const userData = JSON.parse(storedUser);\n        setUserInfo(userData);\n      } catch (error) {\n        console.error(\"Error parsing user data:\", error);\n      }\n    }\n  }, []);\n\n  // ฟังก์ชันแปลง pathname เป็นชื่อหน้า\n  const getPageTitle = () => {\n    const pageMap = {\n      \"/admin/home\": \"หน้าหลัก\",\n      \"/admin/participation\": \"เข้าร่วมกิจกรรม\",\n      \"/admin/event\": \"กิจกรรม\",\n      \"/admin/user\": \"บุคลากร\",\n      \"/admin/report\": \"รายงาน\",\n      \"/admin/profile\": \"โปรไฟล์\",\n      \"/admin/settings\": \"ตั้งค่า\",\n    };\n    return pageMap[pathname] || \"Dashboard\";\n  };\n\n  // สร้าง breadcrumb items\n  const getBreadcrumbItems = () => {\n    const pathArray = pathname.split(\"/\").filter((item) => item);\n    const items = [\n      {\n        title: (\n          <span className=\"flex items-center gap-1\">\n            <Home size={14} />\n            Admin\n          </span>\n        ),\n      },\n    ];\n\n    if (pathArray.length > 1) {\n      const pageMap = {\n        home: \"หน้าหลัก\",\n        participation: \"เข้าร่วมกิจกรรม\",\n        event: \"กิจกรรม\",\n        user: \"บุคลากร\",\n        report: \"รายงาน\",\n        profile: \"โปรไฟล์\",\n        settings: \"ตั้งค่า\",\n      };\n\n      items.push({\n        title: pageMap[pathArray[1]] || pathArray[1],\n      });\n    }\n\n    return items;\n  };\n\n  const handleLogout = () => {\n    // ลบข้อมูลจาก localStorage\n    localStorage.removeItem(\"user\");\n    localStorage.removeItem(\"token\");\n    router.push(\"/login\");\n  };\n\n  const menuItems = [\n    {\n      key: \"profile\",\n      icon: <User size={16} />,\n      label: \"โปรไฟล์\",\n      onClick: () => router.push(\"/admin/profile\"),\n    },\n    {\n      key: \"settings\",\n      icon: <Settings size={16} />,\n      label: \"ตั้งค่า\",\n      onClick: () => router.push(\"/admin/settings\"),\n    },\n    {\n      type: \"divider\",\n    },\n    {\n      key: \"logout\",\n      icon: <LogOut size={16} />,\n      label: \"ออกจากระบบ\",\n      danger: true,\n      onClick: () => handleLogout(),\n    },\n  ];\n\n  return (\n    <header className=\"bg-white shadow-sm border-b border-gray-200 sticky top-0 z-40 w-full\">\n      <div className=\"px-6 py-3\">\n        <div className=\"flex items-center justify-between\">\n          {/* Page Title and Breadcrumb */}\n          <div className=\"flex items-center gap-3\">\n            <div>\n              <h1 className=\"text-lg font-semibold text-gray-800\">\n                {getPageTitle()}\n              </h1>\n              <Breadcrumb\n                items={getBreadcrumbItems()}\n                separator=\"/\"\n                className=\"text-xs\"\n              />\n            </div>\n          </div>\n\n          {/* User Profile */}\n          {userInfo && (\n            <Dropdown\n              menu={{ items: menuItems }}\n              placement=\"bottomRight\"\n              trigger={[\"click\"]}\n            >\n              <div className=\"flex items-center gap-3 cursor-pointer hover:bg-gray-50 px-3 py-2 rounded-lg transition-colors\">\n                <div className=\"text-right\">\n                  <p className=\"text-sm font-medium text-gray-800\">\n                    {userInfo.name || \"ผู้ดูแลระบบ\"}\n                  </p>\n                  <p className=\"text-xs text-gray-500\">\n                    {userInfo.role === \"admin\"\n                      ? \"ผู้ดูแลระบบ\"\n                      : userInfo.role || \"Admin\"}\n                  </p>\n                </div>\n                <Avatar\n                  size={40}\n                  style={{\n                    backgroundColor: \"#3D5753\",\n                    color: \"#fff\",\n                  }}\n                >\n                  {userInfo.name?.charAt(0) || \"A\"}\n                </Avatar>\n              </div>\n            </Dropdown>\n          )}\n        </div>\n      </div>\n    </header>\n  );\n};\n\nexport default AdminHeader;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 287, "column": 0}, "map": {"version":3,"sources":["file:///home/siripoom/tas/tas-front/src/app/admin/layout.js"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport { Layout } from \"antd\";\nimport Sidebar from \"@/components/asset/Sidebar\";\nimport AdminHeader from \"@/components/asset/AdminHeader\";\nimport \"../globals.css\";\n\nconst { Content } = Layout;\n\nexport default function AdminLayout({ children }) {\n  const router = useRouter();\n  const [collapsed, setCollapsed] = useState(false);\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n\n  useEffect(() => {\n    // เช็คการ login และ role จาก localStorage\n    const checkAuth = () => {\n      const storedUser = localStorage.getItem(\"user\");\n      const token = localStorage.getItem(\"token\");\n\n      // เช็คว่ามีทั้ง user และ token หรือไม่\n      if (!storedUser || !token) {\n        // ถ้าไม่มีข้อมูล login ให้ redirect ไปหน้า login\n        router.push(\"/login\");\n        return;\n      }\n\n      try {\n        const userData = JSON.parse(storedUser);\n        console.log(\"User Data:\", userData);\n\n        // เช็คว่า role เป็น admin หรือไม่\n        if (userData.userType !== \"admin\") {\n          // ถ้าไม่ใช่ admin ให้ redirect ไปหน้า login\n          alert(\"คุณไม่มีสิทธิ์เข้าถึงหน้านี้\");\n          localStorage.clear(); // ลบข้อมูลทั้งหมด\n          router.push(\"/login\");\n          return;\n        }\n\n        // ถ้าทุกอย่างผ่าน\n        setIsAuthenticated(true);\n      } catch (error) {\n        console.error(\"Error parsing user data:\", error);\n        localStorage.clear(); // ลบข้อมูลที่เสียหาย\n        router.push(\"/login\");\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    checkAuth();\n  }, [router]);\n\n  // แสดง loading ขณะเช็คการ login\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen bg-gray-50\">\n        <div className=\"text-center\">\n          <div className=\"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-[#3D5753]\"></div>\n          <p className=\"mt-4 text-gray-600\">กำลังตรวจสอบสิทธิ์...</p>\n        </div>\n      </div>\n    );\n  }\n\n  // ถ้ายังไม่ได้ authenticated ไม่แสดงอะไร (จะ redirect แล้ว)\n  if (!isAuthenticated) {\n    return null;\n  }\n\n  return (\n    <Layout style={{ minHeight: \"100vh\" }}>\n      <Sidebar\n        userRole=\"admin\"\n        collapsed={collapsed}\n        onCollapse={setCollapsed}\n      />\n      <Layout\n        style={{\n          marginLeft: collapsed ? 80 : 250,\n          transition: \"margin-left 0.2s\",\n        }}\n      >\n        <AdminHeader />\n        <Content\n          style={{\n            margin: \"24px 16px\",\n            padding: 24,\n            minHeight: \"calc(100vh - 112px)\",\n            background: \"#f5f5f5\",\n          }}\n        >\n          {children}\n        </Content>\n      </Layout>\n    </Layout>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;;;;;;AAEA;AANA;;;;;;;;AASA,MAAM,EAAE,OAAO,EAAE,GAAG,4LAAM;AAEX,SAAS,YAAY,EAAE,QAAQ,EAAE;IAC9C,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC;IAC3C,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,iNAAQ,EAAC;IACvD,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC;IAE3C,IAAA,kNAAS,EAAC;QACR,0CAA0C;QAC1C,MAAM,YAAY;YAChB,MAAM,aAAa,aAAa,OAAO,CAAC;YACxC,MAAM,QAAQ,aAAa,OAAO,CAAC;YAEnC,uCAAuC;YACvC,IAAI,CAAC,cAAc,CAAC,OAAO;gBACzB,iDAAiD;gBACjD,OAAO,IAAI,CAAC;gBACZ;YACF;YAEA,IAAI;gBACF,MAAM,WAAW,KAAK,KAAK,CAAC;gBAC5B,QAAQ,GAAG,CAAC,cAAc;gBAE1B,kCAAkC;gBAClC,IAAI,SAAS,QAAQ,KAAK,SAAS;oBACjC,4CAA4C;oBAC5C,MAAM;oBACN,aAAa,KAAK,IAAI,kBAAkB;oBACxC,OAAO,IAAI,CAAC;oBACZ;gBACF;gBAEA,kBAAkB;gBAClB,mBAAmB;YACrB,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,4BAA4B;gBAC1C,aAAa,KAAK,IAAI,qBAAqB;gBAC3C,OAAO,IAAI,CAAC;YACd,SAAU;gBACR,aAAa;YACf;QACF;QAEA;IACF,GAAG;QAAC;KAAO;IAEX,gCAAgC;IAChC,IAAI,WAAW;QACb,qBACE,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;;;;;kCACf,8OAAC;wBAAE,WAAU;kCAAqB;;;;;;;;;;;;;;;;;IAI1C;IAEA,4DAA4D;IAC5D,IAAI,CAAC,iBAAiB;QACpB,OAAO;IACT;IAEA,qBACE,8OAAC,4LAAM;QAAC,OAAO;YAAE,WAAW;QAAQ;;0BAClC,8OAAC;gBACC,UAAS;gBACT,WAAW;gBACX,YAAY;;;;;;0BAEd,8OAAC,4LAAM;gBACL,OAAO;oBACL,YAAY,YAAY,KAAK;oBAC7B,YAAY;gBACd;;kCAEA,8OAAC,oJAAW;;;;;kCACZ,8OAAC;wBACC,OAAO;4BACL,QAAQ;4BACR,SAAS;4BACT,WAAW;4BACX,YAAY;wBACd;kCAEC;;;;;;;;;;;;;;;;;;AAKX"}}]
}