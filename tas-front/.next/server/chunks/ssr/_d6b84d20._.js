module.exports=[41497,a=>{"use strict";var b=a.i(8193),c=a.i(48908),d=a.i(71141);let e=async()=>(await (0,b.getAllActivities)()).flatMap(a=>(a.attendances||[]).map(b=>({...b,activityId:b.activityId||a.id,activity:a}))),f=async a=>{let b=a.activityId;if(!b)throw Error("activityId is required");let e=await c.default.post(`/activities/${b}/apply`);return{id:e.data.id,activityId:e.data.activityId,userId:e.data.studentUserId,status:(0,d.mapApplicationStatusFromApi)(e.data.status),reason:e.data.remark||null,createdAt:e.data.submittedAt,updatedAt:e.data.updatedAt}},g=async(a,b={})=>{let e=(0,d.mapLegacyAttendanceAction)(b.status),f=await c.default.post(`/approvals/${a}/${"approve"===e?"approve":"request-revision"}`,{remark:b.remark||b.reason||b.rejectReason});return(0,d.normalizeAttendance)(f.data)},h=async a=>(await e()).filter(b=>b.userId===a||b.user?.id===a||b.user?.id===String(a)),i=async a=>{let c=await (0,b.getActivityById)(a);return(c.attendances||[]).map(b=>({...b,activityId:a,activity:c}))};a.s(["createAttendance",0,f,"getAllAttendances",0,e,"getAttendancesByActivity",0,i,"getAttendancesByUser",0,h,"updateAttendance",0,g])},24987,a=>{"use strict";let b=(0,a.i(70106).default)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);a.s(["MapPin",()=>b],24987)},70671,a=>{"use strict";var b=a.i(14698),b=b;let c=b.default;a.s(["Col",0,c],70671)},25125,a=>{"use strict";let b=a.i(67749).Row;a.s(["Row",0,b],25125)},41710,a=>{"use strict";let b=(0,a.i(70106).default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);a.s(["Clock",()=>b],41710)},16201,a=>{"use strict";let b=(0,a.i(70106).default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);a.s(["CheckCircle",()=>b],16201)},84022,a=>{"use strict";var b=a.i(52114);a.s(["Progress",()=>b.default])},24150,a=>{"use strict";var b=a.i(72131),c=a.i(99762),d=a.i(24480),e=a.i(55779),f=a.i(87283),g=a.i(65075),h=a.i(47850),i=a.i(81768),j=a.i(39578),k=a.i(98621),l=a.i(88152),m=a.i(3394),n=a.i(95550),o=a.i(13835);a.i(38539);var p=a.i(93610),q=a.i(94725),r=a.i(79382);let s=(a,b,c,d,e)=>({background:a,border:`${(0,p.unit)(d.lineWidth)} ${d.lineType} ${b}`,[`${e}-icon`]:{color:c}}),t=(0,r.genStyleHooks)("Alert",a=>[(a=>{let{componentCls:b,motionDurationSlow:c,marginXS:d,marginSM:e,fontSize:f,fontSizeLG:g,lineHeight:h,borderRadiusLG:i,motionEaseInOutCirc:j,withDescriptionIconSize:k,colorText:l,colorTextHeading:m,withDescriptionPadding:n,defaultPadding:o}=a;return{[b]:{...(0,q.resetComponent)(a),position:"relative",display:"flex",alignItems:"center",padding:o,wordWrap:"break-word",borderRadius:i,[`&${b}-rtl`]:{direction:"rtl"},[`${b}-section`]:{flex:1,minWidth:0},[`${b}-icon`]:{marginInlineEnd:d,lineHeight:0},"&-description":{display:"none",fontSize:f,lineHeight:h},"&-title":{color:m},[`&${b}-motion-leave`]:{overflow:"hidden",opacity:1,transition:`max-height ${c} ${j}, opacity ${c} ${j},
        padding-top ${c} ${j}, padding-bottom ${c} ${j},
        margin-bottom ${c} ${j}`},[`&${b}-motion-leave-active`]:{maxHeight:0,marginBottom:"0 !important",paddingTop:0,paddingBottom:0,opacity:0}},[`${b}-with-description`]:{alignItems:"flex-start",padding:n,[`${b}-icon`]:{marginInlineEnd:e,fontSize:k,lineHeight:0},[`${b}-title`]:{display:"block",marginBottom:d,color:m,fontSize:g},[`${b}-description`]:{display:"block",color:l}},[`${b}-banner`]:{marginBottom:0,border:"0 !important",borderRadius:0}}})(a),(a=>{let{componentCls:b,colorSuccess:c,colorSuccessBorder:d,colorSuccessBg:e,colorWarning:f,colorWarningBorder:g,colorWarningBg:h,colorError:i,colorErrorBorder:j,colorErrorBg:k,colorInfo:l,colorInfoBorder:m,colorInfoBg:n}=a;return{[b]:{"&-success":s(e,d,c,a,b),"&-info":s(n,m,l,a,b),"&-warning":s(h,g,f,a,b),"&-error":{...s(k,j,i,a,b),[`${b}-description > pre`]:{margin:0,padding:0}}}}})(a),(a=>{let{componentCls:b,iconCls:c,motionDurationMid:d,marginXS:e,fontSizeIcon:f,colorIcon:g,colorIconHover:h}=a;return{[b]:{"&-actions":{marginInlineStart:e},[`${b}-close-icon`]:{marginInlineStart:e,padding:0,overflow:"hidden",fontSize:f,lineHeight:(0,p.unit)(f),backgroundColor:"transparent",border:"none",outline:"none",cursor:"pointer",[`${c}-close`]:{color:g,transition:`color ${d}`,"&:hover":{color:h}}},"&-close-text":{color:g,transition:`color ${d}`,"&:hover":{color:h}}}}})(a)],a=>({withDescriptionIconSize:a.fontSizeHeading3,defaultPadding:`${a.paddingContentVerticalSM}px 12px`,withDescriptionPadding:`${a.paddingMD}px ${a.paddingContentHorizontalLG}px`})),u={success:c.default,info:g.default,error:d.default,warning:f.default},v=a=>{let{icon:c,prefixCls:d,type:e,className:f,style:g}=a,h=u[e]||null;return c?(0,n.replaceElement)(c,b.createElement("span",{className:`${d}-icon`},c),()=>({className:(0,k.clsx)(c.props.className,f),style:g})):b.createElement(h,{className:f,style:g})},w=a=>{let{isClosable:c,prefixCls:d,closeIcon:f,handleClose:g,ariaProps:h}=a,i=!0===f||void 0===f?b.createElement(e.default,null):f;return c?b.createElement("button",{type:"button",onClick:g,className:`${d}-close-icon`,tabIndex:0,...h},i):null},x=b.forwardRef((a,c)=>{let{description:d,prefixCls:e,message:f,title:g,banner:n,className:p,rootClassName:q,style:r,onMouseEnter:s,onMouseLeave:u,onClick:x,afterClose:y,showIcon:z,closable:A,closeText:B,closeIcon:C,action:D,id:E,styles:F,classNames:G,...H}=a,I=g??f,[J,K]=b.useState(!1),L=b.useRef(null);b.useImperativeHandle(c,()=>({nativeElement:L.current}));let{getPrefixCls:M,direction:N,closable:O,closeIcon:P,className:Q,style:R,classNames:S,styles:T}=(0,o.useComponentConfig)("alert"),U=M("alert",e),[V,W]=t(U),{onClose:X,afterClose:Y}=A&&"object"==typeof A?A:{},Z=b=>{K(!0),(X??a.onClose)?.(b)},$=b.useMemo(()=>void 0!==a.type?a.type:n?"warning":"info",[a.type,n]),_=b.useMemo(()=>"object"==typeof A&&!!A.closeIcon||!!B||("boolean"==typeof A?A:!!(!1!==C&&(0,m.default)(C))||!!O),[B,C,A,O]),aa=!!n&&void 0===z||z,ab={...a,prefixCls:U,type:$,showIcon:aa,closable:_},[ac,ad]=(0,l.useMergeSemantic)([S,G],[T,F],{props:ab}),ae=(0,k.clsx)(U,`${U}-${$}`,{[`${U}-with-description`]:!!d,[`${U}-no-icon`]:!aa,[`${U}-banner`]:!!n,[`${U}-rtl`]:"rtl"===N},Q,p,q,ac.root,W,V),af=(0,i.default)(H,{aria:!0,data:!0}),ag=b.useMemo(()=>"object"==typeof A&&A.closeIcon?A.closeIcon:B||(void 0!==C?C:"object"==typeof O&&O.closeIcon?O.closeIcon:P),[C,A,O,B,P]),ah=b.useMemo(()=>{let a=A??O;return"object"==typeof a?(0,i.default)(a,{data:!0,aria:!0}):{}},[A,O]);return b.createElement(h.default,{visible:!J,motionName:`${U}-motion`,motionAppear:!1,motionEnter:!1,onLeaveStart:a=>({maxHeight:a.offsetHeight}),onLeaveEnd:Y??y},({className:c,style:e},f)=>b.createElement("div",{id:E,ref:(0,j.composeRef)(L,f),"data-show":!J,className:(0,k.clsx)(ae,c),style:{...ad.root,...R,...r,...e},onMouseEnter:s,onMouseLeave:u,onClick:x,role:"alert",...af},aa?b.createElement(v,{className:(0,k.clsx)(`${U}-icon`,ac.icon),style:ad.icon,description:d,icon:a.icon,prefixCls:U,type:$}):null,b.createElement("div",{className:(0,k.clsx)(`${U}-section`,ac.section),style:ad.section},I?b.createElement("div",{className:(0,k.clsx)(`${U}-title`,ac.title),style:ad.title},I):null,d?b.createElement("div",{className:(0,k.clsx)(`${U}-description`,ac.description),style:ad.description},d):null),D?b.createElement("div",{className:(0,k.clsx)(`${U}-actions`,ac.actions),style:ad.actions},D):null,b.createElement(w,{isClosable:_,prefixCls:U,closeIcon:ag,handleClose:Z,ariaProps:ah})))});var y=a.i(94956),z=a.i(44460),A=a.i(99438),B=a.i(87822),C=a.i(95852),D=a.i(7859);let E=function(a){function c(){var a,b,d;return(0,y.default)(this,c),b=c,d=arguments,b=(0,A.default)(b),(a=(0,C.default)(this,(0,B.default)()?Reflect.construct(b,d||[],(0,A.default)(this).constructor):b.apply(this,d))).state={error:void 0,info:{componentStack:""}},a}return(0,D.default)(c,a),(0,z.default)(c,[{key:"componentDidCatch",value:function(a,b){this.setState({error:a,info:b})}},{key:"render",value:function(){let{message:a,title:c,description:d,id:e,children:f}=this.props,{error:g,info:h}=this.state,i=c??a,j=h?.componentStack||null,k=void 0===i?(g||"").toString():i;return g?b.createElement(x,{id:e,type:"error",title:k,description:b.createElement("pre",{style:{fontSize:"0.9em",overflowX:"auto"}},void 0===d?j:d)}):f}}])}(b.Component);x.ErrorBoundary=E,a.s(["Alert",0,x],24150)},91329,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(24150),e=a.i(49281),f=a.i(55565),g=a.i(70671),h=a.i(27387),i=a.i(84022),j=a.i(25125),k=a.i(64831),l=a.i(68186),m=a.i(72348),n=a.i(27999),o=a.i(16201),p=a.i(41710),q=a.i(24987),r=a.i(60246),s=a.i(8193),t=a.i(41497),u=a.i(48908);let v=async()=>(await u.default.get("/students/me/progress")).data,w=new Set(["APPLIED","APPROVED","REVISION_REQUIRED"]),x=a=>{if(!a)return"-";let b=new Date(a);return Number.isNaN(b.getTime())?"-":b.toLocaleDateString("th-TH",{year:"numeric",month:"long",day:"numeric"})},y=(a,b)=>{if(!a||!b)return"ไม่ระบุเวลา";let c=new Date(a),d=new Date(b);return Number.isNaN(c.getTime())||Number.isNaN(d.getTime())?"ไม่ระบุเวลา":`${c.toLocaleTimeString("th-TH",{hour:"2-digit",minute:"2-digit"})} - ${d.toLocaleTimeString("th-TH",{hour:"2-digit",minute:"2-digit"})}`},z=a=>a?Array.isArray(a)?a.filter(Boolean):[a]:[];function A(){let[a,u]=(0,c.useState)(null),[A,B]=(0,c.useState)([]),[C,D]=(0,c.useState)([]),[E,F]=(0,c.useState)(null),[G,H]=(0,c.useState)(!0),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)(null),[M,N]=(0,c.useState)(!1),O=async a=>{if(a?.id){H(!0);try{let[b,c,d]=await Promise.all([(0,s.getAllActivities)({status:"OPEN_REGISTRATION"}),(0,t.getAttendancesByUser)(a.id),v()]);B(Array.isArray(b)?b:[]),D(Array.isArray(c)?c:[]),F(d||null)}catch(b){let a=b?.response?.data?.message||"ไม่สามารถโหลดข้อมูลนักศึกษาได้";m.message.error(a)}finally{H(!1)}}};(0,c.useEffect)(()=>{try{let a=localStorage.getItem("user"),b=a?JSON.parse(a):null;u(b),b?.id?O(b):H(!1)}catch(a){H(!1)}},[]);let P=(0,c.useMemo)(()=>new Set(C.map(a=>a.activityId)),[C]),Q=(0,c.useMemo)(()=>A.filter(b=>((a,b)=>{let c={facultyId:b?.facultyId||b?.faculty?.id||null,departmentId:b?.departmentId||b?.department?.id||null,majorId:b?.majorId||b?.major?.id||null},d=z(a.departmentIds),e=z(a.majorIds);if(d.length>0){if(!c.departmentId||!d.includes(c.departmentId))return!1}else if("DEPARTMENT"===a.ownerScope&&a.departmentId){if(!c.departmentId||a.departmentId!==c.departmentId)return!1}else if("FACULTY"===a.ownerScope&&a.facultyId&&(!c.facultyId||a.facultyId!==c.facultyId))return!1;return!(e.length>0)||!!c.majorId&&!!e.includes(c.majorId)})(b,a)),[A,a]),R=(0,c.useMemo)(()=>({totalActivities:Q.length,joinedCount:Q.filter(a=>P.has(a.id)).length}),[Q,P]),S=async()=>{if(K?.id&&a?.id){J(!0);try{await (0,t.createAttendance)({activityId:K.id}),m.message.success(`ลงทะเบียนกิจกรรม "${K.name}" สำเร็จ`),N(!1),L(null),await O(a)}catch(b){let a=b?.response?.data?.message||"ไม่สามารถลงทะเบียนกิจกรรมได้";m.message.error(a)}finally{J(!1)}}};return(0,b.jsx)(k.Spin,{spinning:G,children:(0,b.jsxs)("div",{children:[(0,b.jsx)(f.Card,{className:"mb-6 shadow-sm",style:{background:"linear-gradient(135deg, #0A894C 0%, #0ea258 100%)",border:"none"},children:(0,b.jsxs)("div",{className:"text-white",children:[(0,b.jsxs)("h2",{className:"text-2xl font-bold mb-1",children:["สวัสดี, ",a?.fullname||"นักศึกษา"]}),(0,b.jsx)("p",{className:"text-sm opacity-90",children:"ข้อมูลกิจกรรมและชั่วโมงสะสมของคุณ"})]})}),E&&(0,b.jsx)(f.Card,{className:"mb-4",children:(0,b.jsxs)(j.Row,{gutter:[16,16],children:[(0,b.jsxs)(g.Col,{xs:24,md:8,children:[(0,b.jsx)("div",{className:"text-sm text-gray-500",children:"ชั่วโมงสะสม"}),(0,b.jsx)("div",{className:"text-3xl font-bold text-[#0A894C]",children:E.totalHours||0})]}),(0,b.jsxs)(g.Col,{xs:24,md:8,children:[(0,b.jsx)("div",{className:"text-sm text-gray-500",children:"เป้าหมาย"}),(0,b.jsx)("div",{className:"text-3xl font-bold text-[#0A894C]",children:E.targetHours||60})]}),(0,b.jsxs)(g.Col,{xs:24,md:8,children:[(0,b.jsx)("div",{className:"text-sm text-gray-500",children:"ความคืบหน้า"}),(0,b.jsx)(i.Progress,{percent:E.percent||0,strokeColor:"#0A894C"}),(0,b.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["นอกชั้นเรียน: ",E.breakdown?.completedRecordHours||0," | เข้าร่วมกิจกรรม:"," ",E.breakdown?.approvedActivityHours||0]})]})]})}),(0,b.jsxs)(j.Row,{gutter:[16,16],className:"mb-4",children:[(0,b.jsx)(g.Col,{xs:24,md:12,children:(0,b.jsxs)(f.Card,{children:[(0,b.jsx)("div",{className:"text-sm text-gray-500",children:"กิจกรรมที่เปิดให้คุณเข้าร่วม"}),(0,b.jsx)("div",{className:"text-3xl font-bold text-[#0A894C]",children:R.totalActivities})]})}),(0,b.jsx)(g.Col,{xs:24,md:12,children:(0,b.jsxs)(f.Card,{children:[(0,b.jsx)("div",{className:"text-sm text-gray-500",children:"กิจกรรมที่คุณสมัครแล้ว"}),(0,b.jsx)("div",{className:"text-3xl font-bold text-[#0A894C]",children:R.joinedCount})]})})]}),(0,b.jsxs)(f.Card,{children:[(0,b.jsx)("div",{className:"mb-4",children:(0,b.jsx)("h3",{className:"text-lg font-semibold text-[#0A894C]",children:"รายการกิจกรรมที่เปิดรับสมัคร"})}),0===Q.length?(0,b.jsx)(d.Alert,{type:"info",message:"ไม่พบกิจกรรมที่เปิดรับสมัครสำหรับสาขา/ภาควิชาของคุณ"}):(0,b.jsx)(j.Row,{gutter:[16,16],children:Q.map(a=>{let c=z(a.attendances).filter(a=>w.has(a.status)).length,d=Number(a.maxPeopleCount||a.maxStudents||0),h=d>0&&c>=d,i=P.has(a.id);return(0,b.jsx)(g.Col,{xs:24,md:12,lg:8,children:(0,b.jsxs)(f.Card,{hoverable:!0,style:{borderRadius:12,border:"1px solid #e8f5e9",boxShadow:"0 2px 8px rgba(10, 137, 76, 0.08)"},children:[(0,b.jsx)("div",{className:"mb-2",children:(0,b.jsx)(l.Tag,{color:"green",children:a.typeActivity?.name||"ยังไม่กำหนดประเภท"})}),(0,b.jsx)("h4",{className:"text-base font-semibold mb-3",children:a.name}),(0,b.jsxs)("div",{className:"space-y-2 text-sm text-gray-600 mb-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(n.CalendarCheck,{size:16}),(0,b.jsx)("span",{children:x(a.startAt||a.startDate)})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(p.Clock,{size:16}),(0,b.jsxs)("span",{children:[y(a.startAt||a.startDate,a.endAt||a.endDate)," (",a.hours||a.hour||0," ชั่วโมง)"]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(q.MapPin,{size:16}),(0,b.jsx)("span",{className:"line-clamp-1",children:a.location||a.address||"-"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(r.Users,{size:16}),(0,b.jsxs)("span",{children:[c,"/",d||"-"," คน"]})]})]}),(0,b.jsx)(e.Button,{type:"primary",block:!0,disabled:h||i,onClick:()=>{L(a),N(!0)},style:{backgroundColor:i?"#10b981":h?"#d1d5db":"#0A894C",borderColor:i?"#10b981":h?"#d1d5db":"#0A894C"},children:i?"เข้าร่วมแล้ว":h?"เต็ม":"ลงทะเบียน"})]})},a.id)})})]}),(0,b.jsx)(h.Modal,{title:"ยืนยันการลงทะเบียนกิจกรรม",open:M,onOk:S,onCancel:()=>{N(!1),L(null)},confirmLoading:I,okText:"ยืนยัน",cancelText:"ยกเลิก",okButtonProps:{style:{backgroundColor:"#0A894C",borderColor:"#0A894C"}},children:K&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("h4",{className:"font-semibold",children:K.name}),(0,b.jsxs)("div",{className:"text-sm text-gray-600",children:["วันที่: ",x(K.startAt||K.startDate)]}),(0,b.jsxs)("div",{className:"text-sm text-gray-600",children:["เวลา:"," ",y(K.startAt||K.startDate,K.endAt||K.endDate)]}),(0,b.jsxs)("div",{className:"text-sm text-gray-600",children:["สถานที่: ",K.location||K.address||"-"]}),(0,b.jsxs)("div",{className:"p-3 rounded-lg bg-green-50 border border-green-200 text-green-800 text-sm",children:[(0,b.jsx)(o.CheckCircle,{size:16,className:"inline mr-1"}),"เมื่อผ่านการอนุมัติจะได้รับ ",K.hours||K.hour||0," ชั่วโมง"]})]})})]})})}a.s(["default",()=>A],91329)}];

//# sourceMappingURL=_d6b84d20._.js.map